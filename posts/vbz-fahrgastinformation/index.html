<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Building a VBZ Display Clone - Stefan Schüller</title><meta name=Description content><meta property="og:title" content="Building a VBZ Display Clone"><meta property="og:description" content><meta property="og:type" content="article"><meta property="og:url" content="https://sschueller.github.io/posts/vbz-fahrgastinformation/"><meta property="og:image" content="https://sschueller.github.io/posts/vbz-fahrgastinformation/P_20221106_172806.jpg"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-06T16:37:16+02:00"><meta property="article:modified_time" content="2022-11-12T18:37:16+02:00"><meta property="og:site_name" content="Stefan Schüller"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sschueller.github.io/posts/vbz-fahrgastinformation/P_20221106_172806.jpg"><meta name=twitter:title content="Building a VBZ Display Clone"><meta name=twitter:description content><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://sschueller.github.io/posts/vbz-fahrgastinformation/><link rel=prev href=https://sschueller.github.io/posts/wiring-a-home-with-fiber/><link rel=next href=https://sschueller.github.io/posts/3d-printer-nozzle-camera/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//stats.tei.li/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Building a VBZ Display Clone","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/sschueller.github.io\/posts\/vbz-fahrgastinformation\/"},"genre":"posts","keywords":"LED, OpenData, VBZ, ESP32","wordcount":2651,"url":"https:\/\/sschueller.github.io\/posts\/vbz-fahrgastinformation\/","datePublished":"2022-11-06T16:37:16+02:00","dateModified":"2022-11-12T18:37:16+02:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Stefan Schüller"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"light"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"light"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Stefan Schüller">Stefan Schüller</a></div><div class=menu><div class=menu-inner><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Stefan Schüller">Stefan Schüller</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Building a VBZ Display Clone</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://github.com/sschueller/ title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Stefan Schüller</a></span>&nbsp;<span class=post-category>included in <a href=/categories/projects/><i class="far fa-folder fa-fw" aria-hidden=true></i>projects</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-11-06>2022-11-06</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;2651 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;13 minutes&nbsp;</div></div><div class=featured-image><img class=lazyload src=/svg/loading.min.svg data-src=/posts/vbz-fahrgastinformation/20191127_211847.jpg data-srcset="/posts/vbz-fahrgastinformation/20191127_211847.jpg, /posts/vbz-fahrgastinformation/20191127_211847.jpg 1.5x, /posts/vbz-fahrgastinformation/20191127_211847.jpg 2x" data-sizes=auto alt=/posts/vbz-fahrgastinformation/20191127_211847.jpg title=/posts/vbz-fahrgastinformation/20191127_211847.jpg width=4032 height=2268></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#goal>Goal</a></li><li><a href=#analysis>Analysis</a></li><li><a href=#building>Building</a><ul><li><a href=#getting-the-data>Getting the data</a></li><li><a href=#the-font>The Font</a></li><li><a href=#led-display>LED Display</a></li><li><a href=#code>Code</a></li></ul></li><li><a href=#final-results>Final Results</a></li><li><a href=#cost-breakdown>Cost Breakdown</a></li><li><a href=#todo>Todo</a></li><li><a href=#source>Source</a></li></ul></nav></div></div><div class=content id=content><h2 id=goal>Goal</h2><p>I love these LED style signs that are all over the city of Zürich to show when the next tram/bus is about to arrive.</p><p>Since such a sign is not available for purchase I decided to build my own small desk/wall version.</p><h2 id=analysis>Analysis</h2><p>This is what I was able to gather, may not be 100% correct.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=sign-a-1.jpg data-srcset="sign-a-1.jpg, sign-a-1.jpg 1.5x, sign-a-1.jpg 2x" data-sizes=auto alt=sign-a-1.jpg title="VBZ Fahrgastinformation"></p><ol><li>The line number, can also container letters such as &ldquo;S&rdquo;</li><li>The destination</li><li>&ldquo;Greater than&rdquo; shown when there is a significant delay from the schedule (+3min?)</li><li>Minutes until departure</li><li>Backtick indicating live data</li><li>Tic indicating scheduled data.</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=sign-a-2.jpg data-srcset="sign-a-2.jpg, sign-a-2.jpg 1.5x, sign-a-2.jpg 2x" data-sizes=auto alt=sign-a-2.jpg title="VBZ Fahrgastinformation"></p><ol start=7><li>Icon indicating level entry on this tram/bus</li><li>Icon indication the tram/bus is leaving now (at station)</li><li>Extra information that is scrolled when there is an issue</li></ol><p><img class=lazyload src=/svg/loading.min.svg data-src=P_20221020_074554.jpg data-srcset="P_20221020_074554.jpg, P_20221020_074554.jpg 1.5x, P_20221020_074554.jpg 2x" data-sizes=auto alt=P_20221020_074554.jpg title="VBZ Fahrgastinformation"></p><p>These signs appear to be 56 x 208 single color (Amber) with a dot pitch of around 2mm.</p><h2 id=building>Building</h2><h3 id=getting-the-data>Getting the data</h3><p>Switzerland provides an <a href=https://opentransportdata.swiss target=_blank rel="noopener noreffer">api</a> for public transportation data. This allows anyone to connect to this data and build on top of it. You do however have certain <a href=https://opentransportdata.swiss/de/terms-of-use/ target=_blank rel="noopener noreffer">limits</a> depending on what account type you have. The free account lets you hit the API twice a minute which is enough for what I want. I can also get the live data for the current position of the trams/busses easily via the API.</p><p>To use the data you need to make a free account here: <a href=https://opentransportdata.swiss/de/register/ target=_blank rel="noopener noreffer">https://opentransportdata.swiss/de/register/</a> and generate an API key.</p><p>You can then make simple GET or POST request. I am using the API point <a href=https://api.opentransportdata.swiss/trias2020 target=_blank rel="noopener noreffer">https://api.opentransportdata.swiss/trias2020</a> which is specific for the kind of station data I want.</p><p>Important items in the xml are:</p><ul><li><strong>RequestTimestamp</strong>: Now</li><li><strong>StopPointRef</strong>: The station for which I want the data. This is ID can be looked up from the list available here: <a href=https://opentransportdata.swiss/de/dataset/bav_liste target=_blank rel="noopener noreffer">https://opentransportdata.swiss/de/dataset/bav_liste</a></li><li><strong>DepArrTime</strong>: The time for which I want the data (generally now)</li><li><strong>NumberOfResults</strong>: How many results I want (useful to not run out of memory on the ESP)</li><li><strong>StopEventType</strong>: I only want departures not arrivals</li><li><strong>IncludeRealtimeData</strong>: If available I would like realtime data as well</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-bash data-lang=bash><span style=display:flex><span>curl -XPOST <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>-H <span style=color:#e6db74>&#34;Authorization: XXXXXXXX&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>-H <span style=color:#e6db74>&#34;Content-Type: text/XML&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>https://api.opentransportdata.swiss/trias2020 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>-d <span style=color:#e6db74>&#39;&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&lt;Trias version=&#34;1.1&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xmlns=&#34;http://www.vdv.de/trias&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xmlns:siri=&#34;http://www.siri.org.uk/siri&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    xmlns:xsi=&#34;http://www.w3.org/2001/XMLSchema-instance&#34;&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;ServiceRequest&gt;
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#e6db74>        &lt;siri:RequestTimestamp&gt;2022-11-04T16:01:06.488Z&lt;/siri:RequestTimestamp&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &lt;siri:RequestorRef&gt;API-Explorer&lt;/siri:RequestorRef&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &lt;RequestPayload&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &lt;StopEventRequest&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                &lt;Location&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    &lt;LocationRef&gt;
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#e6db74>                        &lt;StopPointRef&gt;8576193&lt;/StopPointRef&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    &lt;/LocationRef&gt;
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#e6db74>                    &lt;DepArrTime&gt;2022-11-04T17:00:56&lt;/DepArrTime&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                &lt;/Location&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                &lt;Params&gt;
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#e6db74>                    &lt;NumberOfResults&gt;4&lt;/NumberOfResults&gt;
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#e6db74>                    &lt;StopEventType&gt;departure&lt;/StopEventType&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    &lt;IncludePreviousCalls&gt;false&lt;/IncludePreviousCalls&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                    &lt;IncludeOnwardCalls&gt;false&lt;/IncludeOnwardCalls&gt;
</span></span></span><span style=display:flex;background-color:#3c3d38><span><span style=color:#e6db74>                    &lt;IncludeRealtimeData&gt;true&lt;/IncludeRealtimeData&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>                &lt;/Params&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>            &lt;/StopEventRequest&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>        &lt;/RequestPayload&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    &lt;/ServiceRequest&gt;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&lt;/Trias&gt;&#39;</span></span></span></code></pre></div><p>You will get a response similar to this:</p><p>From which I am interested in:</p><ul><li><strong>TimetabledTime</strong>: The scheduled time</li><li><strong>EstimatedTime</strong>: The actual time (may not be available)</li><li><strong>A__NF</strong>: Does the tram/bus have level entry</li><li><strong>DestinationText</strong>: Destination</li></ul><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span><span style=background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">29
</span></span><span style=background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">30
</span></span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">57
</span><span style=background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">58
</span></span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">66
</span><span style=background-color:#3c3d38><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">67
</span></span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">68
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">69
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">70
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">71
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">72
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">73
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">74
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">75
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">76
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;display:grid><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;trias:Trias</span> <span style=color:#a6e22e>xmlns:siri=</span><span style=color:#e6db74>&#34;http://www.siri.org.uk/siri&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>xmlns:trias=</span><span style=color:#e6db74>&#34;http://www.vdv.de/trias&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>xmlns:acsb=</span><span style=color:#e6db74>&#34;http://www.ifopt.org.uk/acsb&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>xmlns:ifopt=</span><span style=color:#e6db74>&#34;http://www.ifopt.org.uk/ifopt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>xmlns:datex2=</span><span style=color:#e6db74>&#34;http://datex2.eu/schema/1_0/1_0&#34;</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;1.1&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;trias:ServiceDelivery&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;siri:ResponseTimestamp&gt;</span>2022-11-06T14:49:26Z<span style=color:#f92672>&lt;/siri:ResponseTimestamp&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;siri:ProducerRef&gt;</span>EFAController10.5.16.20-OJP-EFA01-P<span style=color:#f92672>&lt;/siri:ProducerRef&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;siri:Status&gt;</span>true<span style=color:#f92672>&lt;/siri:Status&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;trias:Language&gt;</span>de<span style=color:#f92672>&lt;/trias:Language&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;trias:CalcTime&gt;</span>68<span style=color:#f92672>&lt;/trias:CalcTime&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;trias:DeliveryPayload&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;trias:StopEventResponse&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;trias:StopEventResponseContext&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&lt;trias:Situations&gt;&lt;/trias:Situations&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;/trias:StopEventResponseContext&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;trias:StopEventResult&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&lt;trias:ResultId&gt;</span>ID-3CBAF30F-2E89-47F2-8A1B-39684A2F1680<span style=color:#f92672>&lt;/trias:ResultId&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&lt;trias:StopEvent&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&lt;trias:ThisCall&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:CallAtStop&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:StopPointRef&gt;</span>8576193<span style=color:#f92672>&lt;/trias:StopPointRef&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:StopPointName&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#f92672>&lt;trias:Text&gt;</span>Zürich, Bellevue<span style=color:#f92672>&lt;/trias:Text&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#f92672>&lt;trias:Language&gt;</span>de<span style=color:#f92672>&lt;/trias:Language&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;/trias:StopPointName&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:ServiceDeparture&gt;</span>
</span></span><span style=display:flex;background-color:#3c3d38><span>                                    <span style=color:#f92672>&lt;trias:TimetabledTime&gt;</span>2022-11-04T16:00:00Z<span style=color:#f92672>&lt;/trias:TimetabledTime&gt;</span>
</span></span><span style=display:flex;background-color:#3c3d38><span>                                    <span style=color:#f92672>&lt;trias:EstimatedTime&gt;</span>2022-11-04T16:00:00Z<span style=color:#f92672>&lt;/trias:EstimatedTime&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;/trias:ServiceDeparture&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:StopSeqNumber&gt;</span>8<span style=color:#f92672>&lt;/trias:StopSeqNumber&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;/trias:CallAtStop&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&lt;/trias:ThisCall&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&lt;trias:Service&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:OperatingDayRef&gt;</span>2022-11-04<span style=color:#f92672>&lt;/trias:OperatingDayRef&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:JourneyRef&gt;</span>ojp:91002::R:j22:780:22002<span style=color:#f92672>&lt;/trias:JourneyRef&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:LineRef&gt;</span>ojp:91002::R<span style=color:#f92672>&lt;/trias:LineRef&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:DirectionRef&gt;</span>return<span style=color:#f92672>&lt;/trias:DirectionRef&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:Mode&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:PtMode&gt;</span>tram<span style=color:#f92672>&lt;/trias:PtMode&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:TramSubmode&gt;</span>cityTram<span style=color:#f92672>&lt;/trias:TramSubmode&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:Name&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#f92672>&lt;trias:Text&gt;</span>Tram<span style=color:#f92672>&lt;/trias:Text&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#f92672>&lt;trias:Language&gt;</span>de<span style=color:#f92672>&lt;/trias:Language&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;/trias:Name&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;/trias:Mode&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:PublishedLineName&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:Text&gt;</span>2<span style=color:#f92672>&lt;/trias:Text&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:Language&gt;</span>de<span style=color:#f92672>&lt;/trias:Language&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;/trias:PublishedLineName&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:OperatorRef&gt;</span>ojp:3849<span style=color:#f92672>&lt;/trias:OperatorRef&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:Attribute&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:Text&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#f92672>&lt;trias:Text&gt;</span>Niederflureinstieg<span style=color:#f92672>&lt;/trias:Text&gt;</span>
</span></span><span style=display:flex><span>                                    <span style=color:#f92672>&lt;trias:Language&gt;</span>de<span style=color:#f92672>&lt;/trias:Language&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;/trias:Text&gt;</span>
</span></span><span style=display:flex;background-color:#3c3d38><span>                                <span style=color:#f92672>&lt;trias:Code&gt;</span>A__NF<span style=color:#f92672>&lt;/trias:Code&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;/trias:Attribute&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:OriginStopPointRef&gt;</span>8576182<span style=color:#f92672>&lt;/trias:OriginStopPointRef&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:OriginText&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:Text&gt;</span>Zürich Tiefenbrunnen, Bahnhof<span style=color:#f92672>&lt;/trias:Text&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:Language&gt;</span>de<span style=color:#f92672>&lt;/trias:Language&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;/trias:OriginText&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:DestinationStopPointRef&gt;</span>8596007<span style=color:#f92672>&lt;/trias:DestinationStopPointRef&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;trias:DestinationText&gt;</span>
</span></span><span style=display:flex;background-color:#3c3d38><span>                                <span style=color:#f92672>&lt;trias:Text&gt;</span>Schlieren, Geissweid<span style=color:#f92672>&lt;/trias:Text&gt;</span>
</span></span><span style=display:flex><span>                                <span style=color:#f92672>&lt;trias:Language&gt;</span>de<span style=color:#f92672>&lt;/trias:Language&gt;</span>
</span></span><span style=display:flex><span>                            <span style=color:#f92672>&lt;/trias:DestinationText&gt;</span>
</span></span><span style=display:flex><span>                        <span style=color:#f92672>&lt;/trias:Service&gt;</span>
</span></span><span style=display:flex><span>                    <span style=color:#f92672>&lt;/trias:StopEvent&gt;</span>
</span></span><span style=display:flex><span>                <span style=color:#f92672>&lt;/trias:StopEventResult&gt;</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>&lt;/trias:StopEventResponse&gt;</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>&lt;/trias:DeliveryPayload&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;/trias:ServiceDelivery&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/trias:Trias&gt;</span></span></span></code></pre></td></tr></table></div></div><h3 id=the-font>The Font</h3><p>These displays have a very unique font and I wanted it to be identical. The only way to achieve this was to build a font from scratch using photos I made of different routes and if I was lucky extra messages with rare characters.</p><pre tabindex=0><code>░░ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ░░ 12
▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ 11
▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ 10
▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ 9
▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ 8
▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ 7
▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ 6
▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ 5
▓▓ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ▓▓ 4
▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ 3
░░ ▓▓ ░░ ░░ ░░ ░░ ▓▓ ░░ 2
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 1
1  2  3  4  5  6  7  8
</code></pre><ul><li>At Station Icon, is shown when the time to arrival is 0</li></ul><pre tabindex=0><code>░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ 12
░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ 11
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 10
░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ 9
░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ 8
░░ ▓▓ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ 7
▓▓ ░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ░░ 6
▓▓ ░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ░░ 5
▓▓ ░░ ░░ ░░ ░░ ░░ ▓▓ ░░ ▓▓ ░░ 4
░░ ▓▓ ░░ ░░ ░░ ▓▓ ░░ ░░ ▓▓ ░░ 3
░░ ░░ ▓▓ ▓▓ ▓▓ ░░ ░░ ░░ ▓▓ ▓▓ 2
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 1
1  2  3  4  5  6  7  8  9  10
</code></pre><ul><li>Accessibility Icon, shown for buses and trams with level entry.</li><li>This also appears to be largest symbol</li></ul><pre tabindex=0><code>░░ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ 12
▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ 11
▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 10
░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ 9
░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ 8
░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ 7
░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ 6
▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ 5
▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ 4
▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ▓▓ ▓▓ 3
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 2
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 1
1  2  3  4  5  6  7  8  9  10 11 12 13
</code></pre><ul><li>All Text is within a 12 pixel heigh frame</li><li>Width depends on the character</li><li>There is alway 1 pixel space between characters</li></ul><pre tabindex=0><code>░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 12
▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ 11
▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ 10
▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ░░ 9
▓▓ ▓▓ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ 8
▓▓ ▓▓ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ 7
▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ░░ ░░ 6
░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ 5
░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ 4
░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ 3
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 2
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 1
1  2  3  4  5  6  7  8  9  10
</code></pre><ul><li>Time to arrival, there is a 2 pixel space between it and the back tic if the time is less than 10</li></ul><pre tabindex=0><code>░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 12
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ░░ ▓▓ ▓▓ 11
░░ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ 10
░░ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ░░ 9
░░ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 8
░░ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ 7
░░ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ 6
░░ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ 5
░░ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ 4
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ 3
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 2
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 1
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 12
░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ▓▓ ░░ 11
░░ ░░ ░░ ▓▓ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ▓▓ ░░ 10
░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ ▓▓ ░░ 9
░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 8
░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ░░ ░░ 7
░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ 6
░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ 5
░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ 4
░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ░░ ░░ 3
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 2
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 1
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 12
░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ▓▓ ░░ 11
░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ▓▓ ░░ 10
░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ ▓▓ ░░ 9
░░ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 8
░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ░░ ░░ 7
░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ 6
░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ 5
░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ░░ ░░ ░░ 4
░░ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ▓▓ ▓▓ ▓▓ ▓▓ ░░ ░░ ░░ ░░ 3
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 2
░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ ░░ 1
1  2  3  4  5  6  7  8  9  10 11 12 13 14 15 16 17
</code></pre><ul><li>Spacing between lines is 2 pixels</li><li>If two digits are shown the space to the tic is only 1</li><li>The 1 is offset from the right by an extra pixel</li><li>The back tic turns into a regular tic at around 15.5 minutes (switch from schedules to GPS ?)</li><li>Distance between words is 6 pixels</li><li>Max destination text is about 124 Characters</li></ul><p>To build the font I decided to use the <a href=https://en.wikipedia.org/wiki/Glyph_Bitmap_Distribution_Format target=_blank rel="noopener noreffer">bdf</a> format for which there is a neat little editor called <a href=http://sofia.nmsu.edu/~mleisher/Software/gbdfed/ target=_blank rel="noopener noreffer">gbdfed</a>. With the bdf font I was able to convert it to work with U8g2lib however I later wanted to use a different display which used the Adafruit GFX library. Adafruit does have a converter but it didn&rsquo;t work for me so I modified it. My version can be found here: <a href=https://github.com/sschueller/bdf2adafruit target=_blank rel="noopener noreffer">https://github.com/sschueller/bdf2adafruit</a></p><h3 id=led-display>LED Display</h3><p>Since I was not able to find anything similar to the actually display I am assume these are custom made by the manufacturer and are not off the shelf LED matrix type modules. This also makes sense since these particular ones have to withstand very nasty weather and temperature conditions.</p><p>I decided to go with one of these RGB LED modules from aliexpress: <a href=https://www.aliexpress.com/item/1005004519022015.html target=_blank rel="noopener noreffer">https://www.aliexpress.com/item/1005004519022015.html</a> . They are actually for large televisions.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/vbz-fahrgastinformation/LED-m.png data-srcset="/posts/vbz-fahrgastinformation/LED-m.png, /posts/vbz-fahrgastinformation/LED-m.png 1.5x, /posts/vbz-fahrgastinformation/LED-m.png 2x" data-sizes=auto alt=/posts/vbz-fahrgastinformation/LED-m.png title="LED Matrix Display" width=740 height=394></p><p>To drive this display it is easiest to use this nice <a href=https://github.com/mrfaptastic/ESP32-HUB75-MatrixPanel-DMA target=_blank rel="noopener noreffer">ESP32-HUB75-MatrixPanel-DMA Library</a> together with a custom PCB such as the one made by <span class="h-card person-mention"><a href=https://github.com/hallard class="u-url url"><img class="u-photo photo" src="https://avatars.githubusercontent.com/u/2471931?v=4" alt=@hallard>&#8201;<span class="p-name fn">@hallard</span></a></span> : <a href=https://github.com/hallard/WeMos-Matrix-Shield-DMA target=_blank rel="noopener noreffer">https://github.com/hallard/WeMos-Matrix-Shield-DMA</a> which works great.</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/posts/vbz-fahrgastinformation/pcb.png data-srcset="/posts/vbz-fahrgastinformation/pcb.png, /posts/vbz-fahrgastinformation/pcb.png 1.5x, /posts/vbz-fahrgastinformation/pcb.png 2x" data-sizes=auto alt=/posts/vbz-fahrgastinformation/pcb.png title=PCB width=484 height=426></p><p>You can upload the gerbers.zip directly to a fab such as JLCPCB and have the boards quite quickly.</p><p>These displays are quite power hungry so make sure you use a power supply that can deliver enough amps.</p><h3 id=code>Code</h3><p>I am using a ESP32 in the WeMos form factor. The whole thing was coded in platform IO. This took quite a but of time but this was mostly due to the fact that I wanted to create libraries and not write everything into main.cpp.</p><h4 id=xml-parsing>xml Parsing</h4><p>XML parsing took a few attempts. At first I tried a few different xml libraries but in the end it was easier to just parse the string directly. This also required a lot less memory.</p><h4 id=display-output>Display output</h4><p>Most time here was spent trying to right justify certain text and positioning. Since the font come via the bdf2adafruit tool all characters are 16 bits wide. This makes the function to get the text width useless and I had to check the cursor advance instead.</p><p>I also had issues with the &ldquo;1&rdquo;. It has 2 spaces after instead of only one, this seems to cause off shifting in certain cases.</p><h4 id=ntp--wifi>NTP / Wifi</h4><p>I used a NTP client to get the current time as well as the popular AutoConnect which lets you configure the ESP32 wifi via a phone on first start.</p><h2 id=final-results>Final Results</h2><p>The closest I could get to the original. I don&rsquo;t know what color exactly is used.
<img class=lazyload src=/svg/loading.min.svg data-src=P_20221106_140836.jpg data-srcset="P_20221106_140836.jpg, P_20221106_140836.jpg 1.5x, P_20221106_140836.jpg 2x" data-sizes=auto alt=P_20221106_140836.jpg title=Clone></p><p>My colored version using the <span class="h-card person-mention"><a href=https://twitter.com/vbz_zueri_linie class="u-url url"><img class="u-photo photo" src=https://pbs.twimg.com/profile_images/1453296421948563459/7M1osliH_400x400.jpg alt=VBZ>&#8201;<span class="p-name fn">VBZ</span></a></span> Tram colors.
<img class=lazyload src=/svg/loading.min.svg data-src=P_20221106_172708.jpg data-srcset="P_20221106_172708.jpg, P_20221106_172708.jpg 1.5x, P_20221106_172708.jpg 2x" data-sizes=auto alt=P_20221106_172708.jpg title=Colored></p><p><img class=lazyload src=/svg/loading.min.svg data-src=P_20221106_172806.jpg data-srcset="P_20221106_172806.jpg, P_20221106_172806.jpg 1.5x, P_20221106_172806.jpg 2x" data-sizes=auto alt=P_20221106_172806.jpg title="Colored from side"></p><h2 id=cost-breakdown>Cost Breakdown</h2><table><thead><tr><th>Part</th><th>Cost</th></tr></thead><tbody><tr><td><a href=https://www.aliexpress.com/item/32858054775.html target=_blank rel="noopener noreffer">ESP32 WeMos CP2104</a></td><td>CHF 5.07</td></tr><tr><td><a href=https://www.aliexpress.com/item/1005004519022015.html target=_blank rel="noopener noreffer">P2 128x64 LED Matrix Module</a></td><td>CHF 34.68</td></tr><tr><td><a href=https://www.aliexpress.com/item/32908431212.html target=_blank rel="noopener noreffer">5V 4A Power Supply</a></td><td>CHF 10.20</td></tr><tr><td><a href=https://jlcpcb.com target=_blank rel="noopener noreffer">PCBs (5) via JLCPCB</a></td><td>CHF 5.70</td></tr><tr><td>BOM for PCB</td><td>~ CHF 2.00</td></tr><tr><td><strong>Total</strong></td><td><strong>CHF 57.65</strong></td></tr></tbody></table><h2 id=todo>Todo</h2><ul><li><p>I am still missing characters so I am in the lookout to hopefully capture the missing ones.
<span class="h-card person-mention"><a href=https://twitter.com/vbz_zueri_linie class="u-url url"><img class="u-photo photo" src=https://pbs.twimg.com/profile_images/1453296421948563459/7M1osliH_400x400.jpg alt=VBZ>&#8201;<span class="p-name fn">VBZ</span></a></span>: Falls ihr mir dabei helfen möchtet, eine ASCII Tabelle wäre wirklich cool.</p></li><li><p>At this time there is no function to display messages such as line issues etc.</p></li><li><p>I have not implemented the &ldquo;>&rdquo; feature.</p></li><li><p>Add more dynamic support for other display sizes. (width is hardcoded at the moment)</p></li><li><p>Figure out a way to only display one direction, at the moment I don&rsquo;t see a simple way to do this with the data I get from the API.</p></li><li><p>Fix spacing issues</p></li><li><p>Fix umlauts in font to be at the correct ASCII position</p></li><li><p>Design a 3d printed wall mount</p></li></ul><h2 id=source>Source</h2><p>The source code is available here: <a href=https://github.com/sschueller/vbz-fahrgastinformation target=_blank rel="noopener noreffer">https://github.com/sschueller/vbz-fahrgastinformation</a></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-11-12</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-title="Building a VBZ Display Clone" data-via=sschueller data-hashtags=LED,OpenData,VBZ,ESP32><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-hashtag=LED><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-title="Building a VBZ Display Clone" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Tumblr" data-sharer=tumblr data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-title="Building a VBZ Display Clone" data-tags=LED,OpenData,VBZ,ESP32><i class="fab fa-tumblr fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-title="Building a VBZ Display Clone"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Reddit" data-sharer=reddit data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/><i class="fab fa-reddit fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on VK" data-sharer=vk data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-title="Building a VBZ Display Clone" data-image=vbz-anzeige><i class="fab fa-vk fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Xing" data-sharer=xing data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-title="Building a VBZ Display Clone"><i class="fab fa-xing fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-title="Building a VBZ Display Clone"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-title="Building a VBZ Display Clone" data-image=vbz-anzeige><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 百度" data-sharer=baidu data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-title="Building a VBZ Display Clone"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/baidu.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Skype" data-sharer=skype data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-title="Building a VBZ Display Clone"><i class="fab fa-skype fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Trello" data-sharer=trello data-url=https://sschueller.github.io/posts/vbz-fahrgastinformation/ data-title="Building a VBZ Display Clone" data-description><i class="fab fa-trello fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/led/>LED</a>,&nbsp;<a href=/tags/opendata/>OpenData</a>,&nbsp;<a href=/tags/vbz/>VBZ</a>,&nbsp;<a href=/tags/esp32/>ESP32</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/wiring-a-home-with-fiber/ class=prev rel=prev title="Wiring my home with Fiber"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>Wiring my home with Fiber</a>
<a href=/posts/3d-printer-nozzle-camera/ class=next rel=next title="3D Printer Nozzle Camera">3D Printer Nozzle Camera<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.110.0">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://github.com/sschueller/ target=_blank>Stefan Schüller</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>